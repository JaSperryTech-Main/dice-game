import{r as x,j as e}from"./vendor-react.DmSwpSGH.js";import{u as C,a as $,b as D,c as S}from"./index.BN2jhS1I.js";import{R as U}from"./vendor.BMDhoA5L.js";const k=new U,E=()=>{const{player:l,addGold:b}=C(),{dice:v}=$(),[i,w]=x.useState(!1),n=x.useRef([]);x.useEffect(()=>{n.current=n.current.slice(0,l.dices.length)},[l.dices]);const y=async()=>{if(i)return;w(!0);const c=[...l.dices],d=l.upgrades.rollSpeed||0,a=c.map(m=>{const o=v[m]||{sides:6,multiplier:1},s=k.roll(`1d${o.sides}`).result;return{diceType:m,result:s,finalResult:s*o.multiplier,sides:o.sides}}),u=a.reduce((m,{finalResult:o})=>m+o,0),f=c.map((m,o)=>new Promise(s=>{var N;const t=(N=n.current[o])==null?void 0:N.querySelector(".dice-text");if(!t){s();return}let r=!1;const g=a[o].sides;t.classList.add("rolling");const p=setInterval(()=>{r||(t.textContent=Math.floor(Math.random()*g)+1)},50),h=Math.random()*3+2,R=Math.min(.5*d*1e3,h*1e3-500),P=Math.max(500,h*1e3-R);setTimeout(()=>{r=!0,clearInterval(p),t.classList.remove("rolling"),t.textContent=a[o].result,s()},P)}));await Promise.all(f),b(u),w(!1)},j={common:"border-gray-400 text-gray-600",uncommon:"border-green-500 text-green-500",rare:"border-blue-500 text-blue-500",epic:"border-purple-500 text-purple-500",legendary:"border-yellow-500 text-yellow-500"};return e.jsxs("div",{className:"flex content-center items-center h-screen w-[66vw] flex-col relative",children:[e.jsx("div",{className:"grid grid-cols-5 gap-x-[5vh] gap-y-[5vw] w-[85%] min-h-[66vh] justify-items-center mt-[5vh] mb-[15vh] overflow-y-auto p-2.5",children:l.dices.map((c,d)=>{const a=v[c]||{multiplier:1};return e.jsxs("div",{ref:u=>n.current[d]=u,className:`dice w-[120px] h-[120px] bg-white border-2 ${j[a.id||"common"]} flex justify-center items-center text-[50px] font-bold rounded-[15px] shadow-[0_4px_8px_rgba(0,0,0,0.2)] transition-transform duration-200 ease-in-out transform hover:scale-105 cursor-pointer relative`,children:[e.jsx("p",{className:"dice-text",children:"1"}),e.jsxs("div",{className:"absolute bottom-2 right-2 text-[16px] font-semibold text-gray-600",children:["x",a.multiplier]})]},`dice-${c}-${d}`)})}),e.jsx("button",{onClick:y,disabled:i,className:`absolute bottom-5 left-1/2 transform -translate-x-1/2 px-8 py-4 text-lg cursor-pointer border-none rounded-full transition-all duration-300 ease-in-out ${i?"bg-gray-400 cursor-not-allowed":"bg-green-500 hover:bg-green-600 text-white"}`,children:i?"Rolling...":"Roll Dice"})]})},O=()=>{const{player:l,removeGold:b,addDice:v,getUpgrades:i,addUpgrade:w}=C(),{upgrades:n}=D(),{Packs:y}=S(),[j,c]=x.useState("upgrades"),[d,a]=x.useState(null),[u,f]=x.useState({}),m=(s,t=1)=>{const r=n.find(h=>h.id===s);if(!r){console.error(`Upgrade ${s} not found.`);return}const g=u[s]||0,p=r.cost*(g+1);l.gold>=p?(b(p),w(s,t),f(h=>({...h,[s]:g+1})),f(i())):console.log(`Need ${p} gold (have ${l.gold})`)},o=(s,t)=>{if(l.gold>=t.cost){b(t.cost);const r=t.chooseItem();v(r),a(s),setTimeout(()=>a(null),250)}else console.log("Not Enough Gold")};return x.useEffect(()=>{f(i())},[l.upgrades]),e.jsxs("aside",{className:"w-[33vw] h-screen border border-black p-5 box-border bg-[#f8f8f8] flex flex-col text-center",children:[e.jsxs("div",{className:"w-full flex justify-between items-center mb-5",children:[e.jsxs("p",{className:"text-lg font-semibold",children:["Gold: ",l.gold]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>c("upgrades"),className:"px-3 py-1 bg-gray-300 rounded hover:bg-gray-400",children:"Upgrades"}),e.jsx("button",{onClick:()=>c("packs"),className:"px-3 py-1 bg-gray-300 rounded hover:bg-gray-400",children:"Packs"})]})]}),j==="upgrades"&&e.jsxs("div",{className:"flex flex-col overflow-x-hidden md:overflow-x-scroll",children:[e.jsx("div",{className:"relative mb-5",children:e.jsx("div",{className:"overflow-x-scroll whitespace-nowrap pb-3",children:e.jsx("div",{className:"flex gap-4 max-h-max mb-1",children:Object.entries(u).filter(([s,t])=>t>0).map(([s,t])=>{const r=n.find(g=>g.id===s);return r?e.jsx("div",{className:"flex-shrink-0 w-[calc(33.33%-1rem)] sm:w-[calc(25%-1rem)] md:w-[calc(20%-1rem)]",children:e.jsxs("div",{className:"flex flex-col items-center p-4 bg-gray-100 rounded-xl shadow-md hover:shadow-lg transition-shadow duration-300",children:[e.jsx("img",{src:r.image,alt:r.title,className:"w-20 h-20 mb-2 object-cover rounded-md"}),e.jsx("span",{className:"font-semibold text-lg",children:r.title}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Owned: ",t]})]})},s):null})})})}),e.jsx("div",{className:"overflow-y-scroll",children:e.jsx("div",{className:"space-y-5 mr-5",children:n.map(s=>{const t=u[s.id]||0,r=s.cost*(t+1);return e.jsxs("div",{className:"grid grid-cols-2 grid-rows-2 gap-3 p-5 border rounded-xl bg-white shadow-lg hover:shadow-xl transition-shadow duration-300",children:[e.jsxs("h2",{className:"col-start-1 row-start-1 self-start justify-self-start text-xl font-semibold text-gray-800",children:[s.title," ",t>0&&`(Lv. ${t})`]}),e.jsxs("h4",{className:"col-start-2 row-start-1 self-start justify-self-end text-md text-gray-700",children:["Cost: ",r]}),e.jsx("p",{className:"col-start-1 row-start-2 self-end justify-self-start text-sm text-gray-500",children:s.description}),e.jsx("button",{onClick:()=>m(s.id),className:`col-start-2 row-start-2 self-end justify-self-end bg-blue-500 text-white px-4 py-2 rounded-lg shadow-md hover:bg-blue-600 transition-all duration-200 ${l.gold<r?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,disabled:l.gold<r,children:t>0?"Upgrade":"Buy"})]},s.id)})})})]}),j==="packs"&&e.jsx("div",{className:"h-full overflow-y-auto flex flex-col gap-4 p-2 border rounded",children:Object.entries(y).map(([s,t])=>e.jsxs("div",{className:"grid grid-cols-1 gap-2 p-4 border rounded bg-white shadow",children:[e.jsx("h2",{className:"text-xl font-bold",children:s}),e.jsxs("p",{className:"text-gray-700",children:["Cost: ",t.cost," coins"]}),e.jsx("button",{className:"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded",onClick:()=>o(s,t),disabled:d===s,children:d===s?"Opened":`Open ${s}`})]},s))})]})},B=()=>e.jsxs("main",{className:"bg-[#e0f7fa] m-0 flex content-center items-center min-h-screen h-full",children:[e.jsx(O,{}),e.jsx(E,{})]});export{B as default};
//# sourceMappingURL=Home.D7v8C5tt.js.map
